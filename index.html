<!DOCT<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>よちゲーム！</title>
<style>
  body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #f0f0f0; }
  #game-area { width: 100%; height: 300px; background: #fff; display: flex; align-items: center; justify-content: center; border: 2px solid #333; margin-bottom: 20px; overflow: hidden; }
  img { max-width: 100%; max-height: 100%; object-fit: contain; }
  .btn { padding: 15px 30px; font-size: 18px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
  .hidden { display: none; }
  #status { font-size: 20px; font-weight: bold; margin-bottom: 10px; }
  #result { margin-top: 20px; font-weight: bold; color: #d32f2f; }
</style>
</head>
<body>

<h1>よちゲーム！</h1>
<div id="status">スタートボタンを押してね</div>
<div id="game-area">
  <span id="placeholder">画像表示エリア</span>
</div>

<button id="action-btn" class="btn" onclick="startGame()">スタート</button>
<button id="tap-btn" class="btn hidden" onclick="handleTap()">彼女だ！(タップ)</button>

<div id="result"></div>

<script>
  // 設定：ファイル名を3枚に変更済み
  const targetImage = 'target.png'; // 彼女
  const otherImages = ['other1.png', 'other2.png', 'other3.png']; // 違う人

  let isPlaying = false;
  let currentImage = '';
  let startTime = 0;
  let reactionTimes = [];
  let mistakeCount = 0;
  let roundCount = 0;
  const maxRounds = 10; // 10回勝負
  let waitTimeout;

  const gameArea = document.getElementById('game-area');
  const actionBtn = document.getElementById('action-btn');
  const tapBtn = document.getElementById('tap-btn');
  const statusDiv = document.getElementById('status');
  const resultDiv = document.getElementById('result');

  function startGame() {
    isPlaying = true;
    reactionTimes = [];
    mistakeCount = 0;
    roundCount = 0;
    resultDiv.innerHTML = '';
    actionBtn.classList.add('hidden');
    tapBtn.classList.remove('hidden'); 
    tapBtn.innerText = "彼女だ！(タップ)";
    nextRound();
  }

  function nextRound() {
    if (roundCount >= maxRounds) {
      endGame();
      return;
    }
    roundCount++;
    statusDiv.innerText = '第 ' + roundCount + ' 問目...';
    gameArea.innerHTML = ''; // 画像クリア
    
    // ランダムな待ち時間 (0.5秒〜2秒)
    const delay = Math.floor(Math.random() * 1500) + 500;
    
    waitTimeout = setTimeout(() => {
      showImage();
    }, delay);
  }

  function showImage() {
    // 50%の確率でターゲット、50%でその他
    const isTarget = Math.random() < 0.5;
    
    if (isTarget) {
      currentImage = targetImage;
    } else {
      // 3枚の中からランダムに選択
      const randIndex = Math.floor(Math.random() * otherImages.length);
      currentImage = otherImages[randIndex];
    }

    const img = document.createElement('img');
    img.src = currentImage;
    img.alt = "画像";
    gameArea.appendChild(img);
    
    startTime = Date.now();

    // 違う人の場合、2秒以内にタップしなければ正解として次へ
    if (!isTarget) {
      waitTimeout = setTimeout(() => {
        if(isPlaying && currentImage !== targetImage) {
           // スルー成功
           nextRound();
        }
      }, 2000); // 2秒表示してタップされなければ次へ
    }
  }
